
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Impact Scan Security Report</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Fira+Code&display=swap" rel="stylesheet">
    <style>
        pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #49483e }
.highlight { background: #272822; color: #F8F8F2 }
.highlight .c { color: #959077 } /* Comment */
.highlight .err { color: #ED007E; background-color: #1E0010 } /* Error */
.highlight .esc { color: #F8F8F2 } /* Escape */
.highlight .g { color: #F8F8F2 } /* Generic */
.highlight .k { color: #66D9EF } /* Keyword */
.highlight .l { color: #AE81FF } /* Literal */
.highlight .n { color: #F8F8F2 } /* Name */
.highlight .o { color: #FF4689 } /* Operator */
.highlight .x { color: #F8F8F2 } /* Other */
.highlight .p { color: #F8F8F2 } /* Punctuation */
.highlight .ch { color: #959077 } /* Comment.Hashbang */
.highlight .cm { color: #959077 } /* Comment.Multiline */
.highlight .cp { color: #959077 } /* Comment.Preproc */
.highlight .cpf { color: #959077 } /* Comment.PreprocFile */
.highlight .c1 { color: #959077 } /* Comment.Single */
.highlight .cs { color: #959077 } /* Comment.Special */
.highlight .gd { color: #FF4689 } /* Generic.Deleted */
.highlight .ge { color: #F8F8F2; font-style: italic } /* Generic.Emph */
.highlight .ges { color: #F8F8F2; font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.highlight .gr { color: #F8F8F2 } /* Generic.Error */
.highlight .gh { color: #F8F8F2 } /* Generic.Heading */
.highlight .gi { color: #A6E22E } /* Generic.Inserted */
.highlight .go { color: #66D9EF } /* Generic.Output */
.highlight .gp { color: #FF4689; font-weight: bold } /* Generic.Prompt */
.highlight .gs { color: #F8F8F2; font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #959077 } /* Generic.Subheading */
.highlight .gt { color: #F8F8F2 } /* Generic.Traceback */
.highlight .kc { color: #66D9EF } /* Keyword.Constant */
.highlight .kd { color: #66D9EF } /* Keyword.Declaration */
.highlight .kn { color: #FF4689 } /* Keyword.Namespace */
.highlight .kp { color: #66D9EF } /* Keyword.Pseudo */
.highlight .kr { color: #66D9EF } /* Keyword.Reserved */
.highlight .kt { color: #66D9EF } /* Keyword.Type */
.highlight .ld { color: #E6DB74 } /* Literal.Date */
.highlight .m { color: #AE81FF } /* Literal.Number */
.highlight .s { color: #E6DB74 } /* Literal.String */
.highlight .na { color: #A6E22E } /* Name.Attribute */
.highlight .nb { color: #F8F8F2 } /* Name.Builtin */
.highlight .nc { color: #A6E22E } /* Name.Class */
.highlight .no { color: #66D9EF } /* Name.Constant */
.highlight .nd { color: #A6E22E } /* Name.Decorator */
.highlight .ni { color: #F8F8F2 } /* Name.Entity */
.highlight .ne { color: #A6E22E } /* Name.Exception */
.highlight .nf { color: #A6E22E } /* Name.Function */
.highlight .nl { color: #F8F8F2 } /* Name.Label */
.highlight .nn { color: #F8F8F2 } /* Name.Namespace */
.highlight .nx { color: #A6E22E } /* Name.Other */
.highlight .py { color: #F8F8F2 } /* Name.Property */
.highlight .nt { color: #FF4689 } /* Name.Tag */
.highlight .nv { color: #F8F8F2 } /* Name.Variable */
.highlight .ow { color: #FF4689 } /* Operator.Word */
.highlight .pm { color: #F8F8F2 } /* Punctuation.Marker */
.highlight .w { color: #F8F8F2 } /* Text.Whitespace */
.highlight .mb { color: #AE81FF } /* Literal.Number.Bin */
.highlight .mf { color: #AE81FF } /* Literal.Number.Float */
.highlight .mh { color: #AE81FF } /* Literal.Number.Hex */
.highlight .mi { color: #AE81FF } /* Literal.Number.Integer */
.highlight .mo { color: #AE81FF } /* Literal.Number.Oct */
.highlight .sa { color: #E6DB74 } /* Literal.String.Affix */
.highlight .sb { color: #E6DB74 } /* Literal.String.Backtick */
.highlight .sc { color: #E6DB74 } /* Literal.String.Char */
.highlight .dl { color: #E6DB74 } /* Literal.String.Delimiter */
.highlight .sd { color: #E6DB74 } /* Literal.String.Doc */
.highlight .s2 { color: #E6DB74 } /* Literal.String.Double */
.highlight .se { color: #AE81FF } /* Literal.String.Escape */
.highlight .sh { color: #E6DB74 } /* Literal.String.Heredoc */
.highlight .si { color: #E6DB74 } /* Literal.String.Interpol */
.highlight .sx { color: #E6DB74 } /* Literal.String.Other */
.highlight .sr { color: #E6DB74 } /* Literal.String.Regex */
.highlight .s1 { color: #E6DB74 } /* Literal.String.Single */
.highlight .ss { color: #E6DB74 } /* Literal.String.Symbol */
.highlight .bp { color: #F8F8F2 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #A6E22E } /* Name.Function.Magic */
.highlight .vc { color: #F8F8F2 } /* Name.Variable.Class */
.highlight .vg { color: #F8F8F2 } /* Name.Variable.Global */
.highlight .vi { color: #F8F8F2 } /* Name.Variable.Instance */
.highlight .vm { color: #F8F8F2 } /* Name.Variable.Magic */
.highlight .il { color: #AE81FF } /* Literal.Number.Integer.Long */
        body {
            font-family: 'Inter', 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
            background-color: #000000;
            color: #FFFFFF;
            line-height: 1.6;
            margin: 0;
            padding: 0;
        }
        .container {
            max-width: 1400px;
            margin: auto;
            background: #000000;
            padding: 20px;
            border: 1px solid #333;
        }
        .report-header {
            text-align: center;
            padding: 40px 20px;
            background-color: #000000;
            border-bottom: 1px solid #333;
        }
        .report-header h1 {
            font-size: 2.8em;
            font-weight: 700;
            color: #FFFFFF;
            margin: 0;
        }
        .report-subtitle {
            font-size: 1.2em;
            color: #FFFFFF;
            margin-top: 10px;
        }
        .report-meta {
            font-size: 0.9em;
            color: #FFFFFF;
        }
        .section {
            margin-bottom: 20px;
        }
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
            background-color: #000000;
            border-bottom: 1px solid #333;
        }
        .section-title {
            font-size: 1.8em;
            color: #FFFFFF;
            margin: 0;
        }
        .section-content {
            padding: 20px;
            background-color: #000000;
        }
        .metrics-grid {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        .metric-item {
            background-color: #000000;
            padding: 15px 25px;
            text-align: center;
            min-width: 120px;
            border-left: 5px solid;
        }
        .metric-item .metric-number {
            font-size: 2.5em;
            font-weight: bold;
        }
        .metric-item .metric-label {
            font-size: 1em;
            color: #FFFFFF;
        }
        .metric-item.critical { border-color: #d73a49; }
        .metric-item.high { border-color: #cb2431; }
        .metric-item.medium { border-color: #f1e05a; }
        .metric-item.low { border-color: #0366d6; }
        .metric-item .critical { color: #d73a49; }
        .metric-item .high { color: #cb2431; }
        .metric-item .medium { color: #f1e05a; }
        .metric-item .low { color: #0366d6; }

        .severity-section {
            margin-bottom: 30px;
        }
        .severity-title {
            padding: 10px 15px;
            color: #FFFFFF;
            margin-bottom: 20px;
            font-size: 1.5em;
        }
        .severity-title.critical { background-color: #d73a49; }
        .severity-title.high { background-color: #cb2431; }
        .severity-title.medium { background-color: #b08800; }
        .severity-title.low { background-color: #0366d6; }

        .findings-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
        }
        .finding-card {
            background-color: #000000;
            border: 1px solid #333;
            margin-bottom: 25px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            transition: box-shadow 0.3s ease;
            overflow: hidden;
        }
        .finding-card:hover {
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }
        .card-header {
            padding: 15px 20px;
            border-bottom: 1px solid #333;
        }
        .card-header h3 {
            margin: 0;
            font-size: 1.4em;
            font-weight: 600;
            display: flex;
            align-items: center;
        }
        .card-header .fas {
            margin-right: 12px;
            font-size: 1.2em;
        }
        .card-header.critical { background-color: rgba(215, 58, 73, 0.1); border-left: 5px solid #d73a49; }
        .card-header.high { background-color: rgba(203, 36, 49, 0.1); border-left: 5px solid #cb2431; }
        .card-header.medium { background-color: rgba(241, 224, 90, 0.1); border-left: 5px solid #f1e05a; }
        .card-header.low { background-color: rgba(3, 102, 214, 0.1); border-left: 5px solid #0366d6; }

        .card-body {
            padding: 20px;
        }
        .card-body h4 {
            color: #FFFFFF;
            margin-top: 1em;
            margin-bottom: 0.5em;
            border-bottom: 1px solid #333;
            padding-bottom: 5px;
        }
        .card-body p, .card-body ul {
            margin-bottom: 1em;
        }
        .card-body ul {
            padding-left: 20px;
        }
        .card-body a {
            color: #58a6ff;
            text-decoration: none;
        }
        .card-body a:hover {
            text-decoration: underline;
        }
        .finding-location {
            background-color: #000000;
            padding: 8px 12px;
            margin-bottom: 1em;
            font-family: 'Fira Code', monospace;
            border: 1px solid #333;
        }
        .citations-container {
            margin-top: 15px;
            padding: 10px;
            background-color: #000000;
            border: 1px solid #333;
        }
        .citation-link {
            margin-bottom: 5px;
        }
        .citation-link a {
            color: #58a6ff;
            text-decoration: none;
        }
        .citation-link a:hover {
            text-decoration: underline;
        }
        .grid-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 15px;
        }
        .grid-item h4 {
            font-size: 1.2em;
            color: #FFFFFF;
            margin-top: 0;
            margin-bottom: 10px;
            border-bottom: 2px solid #333;
            padding-bottom: 5px;
        }
        .code-container {
            background-color: #000000;
            padding: 15px;
            overflow-x: auto;
            max-height: 400px;
            border: 1px solid #333;
        }
        .highlight pre {
            margin: 0;
            font-family: 'Fira Code', 'Courier New', monospace;
            font-size: 0.9em;
        }
        .report-footer {
            text-align: center;
            padding: 20px;
            margin-top: 40px;
            color: #FFFFFF;
            font-size: 0.9em;
        }
        /* Diff styles */
        .highlight .gd {
            background-color: rgba(215, 58, 73, 0.2);
            display: block;
        }
        .highlight .gi {
            background-color: rgba(46, 160, 67, 0.2);
            display: block;
        }
        .highlight .gu {
            color: #FFFFFF;
            font-weight: bold;
        }
        .card-footer {
            padding: 10px 20px;
            font-size: 0.9em;
            color: #FFFFFF;
            background-color: #000000;
            border-top: 1px solid #333;
        }
    </style>
</head>
<body>
    <div class="container">
        
        <div class="report-header">
            <h1>Security Scan Report</h1>
            <p class="report-subtitle">Project: /home/anirudh/Projects/impact-scan/dvpwa-test/dvpwa</p>
            <div class="report-meta">
                Generated on: 2025-09-15 23:44:56
            </div>
        </div>
        <div class="section">
            <div class="section-header">
                <h2 class="section-title">Executive Summary</h2>
            </div>
            <div class="section-content">
                <div class="metrics-grid">
                    <div class="metric-item critical">
                        <div class="metric-number">0</div>
                        <div class="metric-label">Critical</div>
                    </div>
                    <div class="metric-item high">
                        <div class="metric-number">1</div>
                        <div class="metric-label">High</div>
                    </div>
                    <div class="metric-item medium">
                        <div class="metric-number">3</div>
                        <div class="metric-label">Medium</div>
                    </div>
                    <div class="metric-item low">
                        <div class="metric-number">2</div>
                        <div class="metric-label">Low</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="severity-section"><h2 class="severity-title high"><i class="fas fa-exclamation-triangle"></i> HIGH (1)</h2><div class="findings-grid">
        <div class="finding-card" id="finding-0">
            <div class="card-header high">
                <h3><i class="fas fa-exclamation-triangle"></i> hashlib</h3>
            </div>
            <div class="card-body">
                <div class="finding-location">
                    <i class="fas fa-file-code"></i> <strong>File:</strong> /home/anirudh/Projects/impact-scan/dvpwa-test/dvpwa/sqli/dao/user.py
                </div>
                <div class="grid-container">
                    <div class="grid-item">
                        <h4><i class="fas fa-exclamation-triangle"></i> Vulnerable Code</h4>
                        <div class="code-container"><div class="highlight"><pre><span></span><span class="mi">40</span>     <span class="k">def</span><span class="w"> </span><span class="nf">check_password</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="mi">41</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pwd_hash</span> <span class="o">==</span> <span class="n">md5</span><span class="p">(</span><span class="n">password</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</pre></div>
</div>
                    </div>
                    <div class="grid-item">
                        <h4><i class="fas fa-shield-alt"></i> Secure Code Fix</h4>
                        <div class="code-container"><div class="highlight"><pre><span></span><span class="err">```</span><span class="n">diff</span>
<span class="o">---</span> <span class="n">a</span><span class="o">/</span><span class="n">dvpwa</span><span class="o">/</span><span class="n">sqli</span><span class="o">/</span><span class="n">dao</span><span class="o">/</span><span class="n">user</span><span class="o">.</span><span class="n">py</span>
<span class="o">+++</span> <span class="n">b</span><span class="o">/</span><span class="n">dvpwa</span><span class="o">/</span><span class="n">sqli</span><span class="o">/</span><span class="n">dao</span><span class="o">/</span><span class="n">user</span><span class="o">.</span><span class="n">py</span>
<span class="o">@@</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span> <span class="o">+</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span> <span class="o">@@</span>
 
     <span class="k">def</span><span class="w"> </span><span class="nf">check_password</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
         <span class="n">hashed_password</span> <span class="o">=</span> <span class="n">md5</span><span class="p">(</span><span class="n">password</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
<span class="o">-</span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pwd_hash</span> <span class="o">==</span> <span class="n">hashed_password</span>
<span class="o">+</span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pwd_hash</span> <span class="o">==</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">pbkdf2_hmac</span><span class="p">(</span><span class="s1">&#39;sha256&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">),</span> <span class="n">salt</span><span class="p">,</span> <span class="mi">100000</span><span class="p">)</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>
 
     <span class="k">def</span><span class="w"> </span><span class="nf">get_user_by_email</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">email</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>

<span class="err">```</span>
</pre></div>
</div>
                    </div>
                </div>

                <h4><i class="fas fa-lightbulb"></i> AI-Powered Explanation</h4>
                <div class="ai-explanation">
                    1. **Vulnerability Analysis:**<br><br>The code is vulnerable because it uses the MD5 hashing algorithm, which is cryptographically weak and susceptible to collision attacks.  This allows attackers to potentially find passwords with the same hash, compromising user authentication.<br><br><br>2. **Secure Code Fix:**<br><br>```diff<br>--- a/home/anirudh/Projects/impact-scan/dvpwa-test/dvpwa/sqli/dao/user.py<br>+++ b/home/anirudh/Projects/impact-scan/dvpwa-test/dvpwa/sqli/dao/user.py<br>@@ -39,7 +39,10 @@<br> <br>     def check_password(self, password: str):<br>         import hashlib<br>-        return self.pwd_hash == md5(password.encode(&#x27;utf-8&#x27;)).hexdigest()<br>+        salt = b&quot;your_unique_and_long_salt&quot; # Replace with a securely generated, unique salt for each user.  Store this salt alongside the password hash.<br>+        hashed_password = hashlib.pbkdf2_hmac(&#x27;sha256&#x27;, password.encode(&#x27;utf-8&#x27;), salt, 100000) # Increase iterations as needed.<br>+        return self.pwd_hash == hashed_password.hex()<br><br>```<br><br>3. **Justification and Citation:**<br><br>This fix uses PBKDF2 with SHA256, a key derivation function that is significantly more resistant to brute-force and rainbow table attacks than MD5.  The inclusion of a unique salt for each user further enhances security by preventing pre-computed hash lookups.<br><br>[https://crackstation.net/hashing-security.htm](https://crackstation.net/hashing-security.htm)  (This link discusses the weaknesses of MD5 and the importance of using stronger hashing algorithms and salting.)  Note:  While this link doesn&#x27;t explicitly mention PBKDF2, it strongly advocates for the use of strong, salted hashing algorithms like bcrypt or scrypt, which PBKDF2 falls under the umbrella of.  The choice of PBKDF2 with SHA256 is a widely accepted secure alternative to MD5.  Remember to generate strong, unique salts and store them securely.  Consider using a library to handle this securely.<br>
                </div>
                
            </div>
            <div class="card-footer">
                <strong>Rule ID:</strong> B324 | <strong>Source:</strong> static_analysis
            </div>
        </div>
        </div></div><div class="severity-section"><h2 class="severity-title medium"><i class="fas fa-exclamation-circle"></i> MEDIUM (3)</h2><div class="findings-grid">
        <div class="finding-card" id="finding-0">
            <div class="card-header medium">
                <h3><i class="fas fa-exclamation-circle"></i> hardcoded_sql_expressions</h3>
            </div>
            <div class="card-body">
                <div class="finding-location">
                    <i class="fas fa-file-code"></i> <strong>File:</strong> /home/anirudh/Projects/impact-scan/dvpwa-test/dvpwa/sqli/dao/student.py
                </div>
                <div class="grid-container">
                    <div class="grid-item">
                        <h4><i class="fas fa-exclamation-triangle"></i> Vulnerable Code</h4>
                        <div class="code-container"><div class="highlight"><pre><span></span><span class="mi">41</span>     <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">create</span><span class="p">(</span><span class="n">conn</span><span class="p">:</span> <span class="n">Connection</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="mi">42</span>         <span class="n">q</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;INSERT INTO students (name) &quot;</span>
<span class="mi">43</span>              <span class="s2">&quot;VALUES (&#39;</span><span class="si">%(name)s</span><span class="s2">&#39;)&quot;</span> <span class="o">%</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">})</span>
<span class="mi">44</span>         <span class="k">async</span> <span class="k">with</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span> <span class="k">as</span> <span class="n">cur</span><span class="p">:</span>
</pre></div>
</div>
                    </div>
                    <div class="grid-item">
                        <h4><i class="fas fa-shield-alt"></i> Secure Code Fix</h4>
                        <div class="code-container"><div class="highlight"><pre><span></span><span class="err">```</span><span class="n">diff</span>
<span class="o">---</span> <span class="n">a</span><span class="o">/</span><span class="n">dvpwa</span><span class="o">-</span><span class="n">test</span><span class="o">/</span><span class="n">dvpwa</span><span class="o">/</span><span class="n">sqli</span><span class="o">/</span><span class="n">dao</span><span class="o">/</span><span class="n">student</span><span class="o">.</span><span class="n">py</span>
<span class="o">+++</span> <span class="n">b</span><span class="o">/</span><span class="n">dvpwa</span><span class="o">-</span><span class="n">test</span><span class="o">/</span><span class="n">dvpwa</span><span class="o">/</span><span class="n">sqli</span><span class="o">/</span><span class="n">dao</span><span class="o">/</span><span class="n">student</span><span class="o">.</span><span class="n">py</span>
<span class="o">@@</span> <span class="o">-</span><span class="mi">41</span><span class="p">,</span><span class="mi">8</span> <span class="o">+</span><span class="mi">41</span><span class="p">,</span><span class="mi">7</span> <span class="o">@@</span>
 
     <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">create</span><span class="p">(</span><span class="n">conn</span><span class="p">:</span> <span class="n">Connection</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
         <span class="n">q</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;INSERT INTO students (name) &quot;</span>
<span class="o">-</span>             <span class="s2">&quot;VALUES (&#39;</span><span class="si">%(name)s</span><span class="s2">&#39;)&quot;</span> <span class="o">%</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">})</span>
<span class="o">-</span>            <span class="k">async</span> <span class="k">with</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span> <span class="k">as</span> <span class="n">cur</span><span class="p">:</span>
<span class="o">+</span>             <span class="s2">&quot;VALUES (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="o">+</span>        <span class="k">async</span> <span class="k">with</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span> <span class="k">as</span> <span class="n">cur</span><span class="p">:</span>
             <span class="k">await</span> <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">q</span><span class="p">,(</span><span class="n">name</span><span class="p">,))</span>

<span class="err">```</span>
</pre></div>
</div>
                    </div>
                </div>

                <h4><i class="fas fa-lightbulb"></i> AI-Powered Explanation</h4>
                <div class="ai-explanation">
                    1. **Vulnerability Analysis:**<br><br>The code is vulnerable because it uses string formatting (`%` operator) to construct the SQL query directly from user-supplied input (`name`). This allows an attacker to inject malicious SQL code into the query, potentially modifying or deleting data, or gaining unauthorized access to the database.<br><br><br>2. **Secure Code Fix:**<br><br>```diff<br>--- a/home/anirudh/Projects/impact-scan/dvpwa-test/dvpwa/sqli/dao/student.py<br>+++ b/home/anirudh/Projects/impact-scan/dvpwa-test/dvpwa/sqli/dao/student.py<br>@@ -41,9 +41,8 @@<br> <br> 41     async def create(conn: Connection, name: str):<br>-42         q = (&quot;INSERT INTO students (name) &quot;<br>-43              &quot;VALUES (&#x27;%(name)s&#x27;)&quot; % {&#x27;name&#x27;: name})<br>-44         async with conn.cursor() as cur:<br>+42         async with conn.cursor() as cur:<br>+43             await cur.execute(&quot;INSERT INTO students (name) VALUES (%s)&quot;, (name,))<br> <br> <br> ```<br><br>3. **Justification and Citation:**<br><br>This fix uses parameterized queries (with `%s` placeholder and a tuple of parameters), preventing SQL injection.  The database driver will properly escape any special characters in the input `name`, ensuring that it&#x27;s treated as data, not executable code.<br><br>[https://owasp.org/www-project-top-ten/2017/A1_Injection](https://owasp.org/www-project-top-ten/2017/A1_Injection)  (OWASP&#x27;s explanation of SQL Injection and the importance of parameterized queries)<br>
                </div>
                
            </div>
            <div class="card-footer">
                <strong>Rule ID:</strong> B608 | <strong>Source:</strong> static_analysis
            </div>
        </div>
        
        <div class="finding-card" id="finding-1">
            <div class="card-header medium">
                <h3><i class="fas fa-exclamation-circle"></i> Vulnerable Dependency: aiohttp@3.5.3</h3>
            </div>
            <div class="card-body">
                <div class="finding-location">
                    <i class="fas fa-file-code"></i> <strong>File:</strong> /home/anirudh/Projects/impact-scan/dvpwa-test/dvpwa/requirements.txt
                </div>
                <div class="grid-container">
                    <div class="grid-item">
                        <h4><i class="fas fa-exclamation-triangle"></i> Vulnerable Code</h4>
                        <div class="code-container"><pre><code>aiohttp==3.5.3</code></pre></div>
                    </div>
                    <div class="grid-item">
                        <h4><i class="fas fa-shield-alt"></i> Secure Code Fix</h4>
                        <div class="code-container"><div class="highlight"><pre><span></span><span class="err">```</span><span class="n">diff</span>
<span class="o">---</span> <span class="n">a</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">anirudh</span><span class="o">/</span><span class="n">Projects</span><span class="o">/</span><span class="n">impact</span><span class="o">-</span><span class="n">scan</span><span class="o">/</span><span class="n">dvpwa</span><span class="o">-</span><span class="n">test</span><span class="o">/</span><span class="n">dvpwa</span><span class="o">/</span><span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
<span class="o">+++</span> <span class="n">b</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">anirudh</span><span class="o">/</span><span class="n">Projects</span><span class="o">/</span><span class="n">impact</span><span class="o">-</span><span class="n">scan</span><span class="o">/</span><span class="n">dvpwa</span><span class="o">-</span><span class="n">test</span><span class="o">/</span><span class="n">dvpwa</span><span class="o">/</span><span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
<span class="o">@@</span> <span class="o">-</span><span class="mi">1</span> <span class="o">+</span><span class="mi">1</span> <span class="o">@@</span>
<span class="o">-</span><span class="n">aiohttp</span><span class="o">==</span><span class="mf">3.5.3</span>
<span class="o">+</span><span class="n">aiohttp</span><span class="o">&gt;=</span><span class="mf">3.8.3</span>
<span class="err">```</span>
</pre></div>
</div>
                    </div>
                </div>

                <h4><i class="fas fa-lightbulb"></i> AI-Powered Explanation</h4>
                <div class="ai-explanation">
                    1. **Vulnerability Analysis:** The code is vulnerable because it uses `aiohttp==3.5.3`, a version with numerous known security flaws, including HTTP request smuggling, directory traversal, denial-of-service vulnerabilities, cross-site scripting, and open redirect vulnerabilities as detailed in the provided vulnerability descriptions.  These flaws stem from weaknesses in the HTTP parser and middleware components.<br><br><br>2. **Secure Code Fix:**<br><br>```diff<br>--- a/home/anirudh/Projects/impact-scan/dvpwa-test/dvpwa/requirements.txt<br>+++ b/home/anirudh/Projects/impact-scan/dvpwa-test/dvpwa/requirements.txt<br>@@ -1,3 +1,3 @@<br>- aiohttp==3.5.3<br>-+ aiohttp&gt;=4.0.0<br>```<br><br>3. **Justification and Citation:**  The fix upgrades `aiohttp` to version 4.0.0 or higher. This addresses the numerous vulnerabilities present in 3.5.3 because later versions incorporate security patches that mitigate the identified HTTP request smuggling, directory traversal, denial-of-service, cross-site scripting, and open redirect vulnerabilities.  While a specific CVE isn&#x27;t directly linked to the upgrade, the release notes and security advisories for aiohttp (though not always explicitly listing every single fix) confirm that significant security improvements were made in versions 4.0.0 and beyond.  Checking the aiohttp release history and changelog on PyPI or GitHub is crucial for verifying the specific fixes included in each version.  (Unfortunately, a single, definitive URL covering all these fixes across multiple CVEs in one place is unlikely to exist; the best practice is to consult the release notes and changelogs directly for each version jump.)  For example, see the PyPI page for aiohttp for release history: [https://pypi.org/project/aiohttp/](https://pypi.org/project/aiohttp/) (Examine the release notes for versions after 3.5.3).<br>
                </div>
                
            </div>
            <div class="card-footer">
                <strong>Rule ID:</strong> PYSEC-2021-76, PYSEC-2023-120, PYSEC-2023-246, PYSEC-2023-247, PYSEC-2023-250, PYSEC-2023-251, PYSEC-2024-24, PYSEC-2024-26, GHSA-45c4-8wx5-qw6w, GHSA-5h86-8mv2-jq9f, GHSA-5m98-qgg9-wh84, GH... | <strong>Source:</strong> dependency
            </div>
        </div>
        
        <div class="finding-card" id="finding-2">
            <div class="card-header medium">
                <h3><i class="fas fa-exclamation-circle"></i> Vulnerable Dependency: jinja2@2.10</h3>
            </div>
            <div class="card-body">
                <div class="finding-location">
                    <i class="fas fa-file-code"></i> <strong>File:</strong> /home/anirudh/Projects/impact-scan/dvpwa-test/dvpwa/requirements.txt
                </div>
                <div class="grid-container">
                    <div class="grid-item">
                        <h4><i class="fas fa-exclamation-triangle"></i> Vulnerable Code</h4>
                        <div class="code-container"><pre><code>jinja2==2.10</code></pre></div>
                    </div>
                    <div class="grid-item">
                        <h4><i class="fas fa-shield-alt"></i> Secure Code Fix</h4>
                        <div class="code-container"><div class="highlight"><pre><span></span><span class="err">```</span><span class="n">diff</span>
<span class="o">---</span> <span class="n">a</span><span class="o">/</span><span class="n">dvpwa</span><span class="o">/</span><span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
<span class="o">+++</span> <span class="n">b</span><span class="o">/</span><span class="n">dvpwa</span><span class="o">/</span><span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
<span class="o">@@</span> <span class="o">-</span><span class="mi">1</span> <span class="o">+</span><span class="mi">1</span> <span class="o">@@</span>
<span class="o">-</span><span class="n">jinja2</span><span class="o">==</span><span class="mf">2.10</span>
<span class="o">+</span><span class="n">jinja2</span><span class="o">&gt;=</span><span class="mf">3.1.2</span>
<span class="err">```</span>
</pre></div>
</div>
                    </div>
                </div>

                <h4><i class="fas fa-lightbulb"></i> AI-Powered Explanation</h4>
                <div class="ai-explanation">
                    1. **Vulnerability Analysis:**<br><br>The `jinja2==2.10` specification in the `requirements.txt` file installs a vulnerable version of the Jinja2 templating engine.  This version contains multiple vulnerabilities, including sandbox escapes and ReDoS, allowing attackers to potentially execute arbitrary code or cause denial-of-service conditions.<br><br><br>2. **Secure Code Fix:**<br><br>```diff<br>--- a//home/anirudh/Projects/impact-scan/dvpwa-test/dvpwa/requirements.txt<br>+++ b//home/anirudh/Projects/impact-scan/dvpwa-test/dvpwa/requirements.txt<br>@@ -1,3 +1,3 @@<br>- jinja2==2.10<br>-+ jinja2&gt;=3.1.2<br>```<br><br>3. **Justification and Citation:**<br><br>Upgrading Jinja2 to version 3.1.2 or later mitigates the identified vulnerabilities.  These later versions include numerous security patches addressing the sandbox escapes and ReDoS issues present in 2.10.  While a specific CVE isn&#x27;t directly linked to a single fix in the upgrade, the release notes and security advisories for Jinja2 across multiple versions confirm the resolution of these classes of vulnerabilities in later releases.  Referencing a specific CVE is difficult as multiple CVEs cover different aspects of the vulnerability in 2.10.  Instead, we rely on the general upgrade recommendation to a secure version: [https://jinja.palletsprojects.com/en/3.1.x/](https://jinja.palletsprojects.com/en/3.1.x/) (Check the release notes and security advisories linked from this page for details on specific vulnerability fixes across versions).  The lack of a single, easily-cited CVE is common for vulnerabilities addressed through comprehensive version upgrades.<br>
                </div>
                
            </div>
            <div class="card-footer">
                <strong>Rule ID:</strong> PYSEC-2019-217, PYSEC-2021-66, GHSA-462w-v97r-4m45, GHSA-cpwx-vrp4-4pq7, GHSA-g3rq-g295-4j3m, GHSA-h5c8-rqwp-cp95, GHSA-h75v-3vvj-5mfj, GHSA-q2x7-8rv6-6q7h | <strong>Source:</strong> dependency
            </div>
        </div>
        </div></div><div class="severity-section"><h2 class="severity-title low"><i class="fas fa-info-circle"></i> LOW (2)</h2><div class="findings-grid">
        <div class="finding-card" id="finding-0">
            <div class="card-header low">
                <h3><i class="fas fa-info-circle"></i> Vulnerable Dependency: idna@2.8</h3>
            </div>
            <div class="card-body">
                <div class="finding-location">
                    <i class="fas fa-file-code"></i> <strong>File:</strong> /home/anirudh/Projects/impact-scan/dvpwa-test/dvpwa/requirements.txt
                </div>
                <div class="grid-container">
                    <div class="grid-item">
                        <h4><i class="fas fa-exclamation-triangle"></i> Vulnerable Code</h4>
                        <div class="code-container"><pre><code>idna==2.8</code></pre></div>
                    </div>
                    <div class="grid-item">
                        <h4><i class="fas fa-shield-alt"></i> Secure Code Fix</h4>
                        <div class="code-container"><div class="highlight"><pre><span></span><span class="err">```</span><span class="n">diff</span>
<span class="o">---</span> <span class="n">a</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">anirudh</span><span class="o">/</span><span class="n">Projects</span><span class="o">/</span><span class="n">impact</span><span class="o">-</span><span class="n">scan</span><span class="o">/</span><span class="n">dvpwa</span><span class="o">-</span><span class="n">test</span><span class="o">/</span><span class="n">dvpwa</span><span class="o">/</span><span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
<span class="o">+++</span> <span class="n">b</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">anirudh</span><span class="o">/</span><span class="n">Projects</span><span class="o">/</span><span class="n">impact</span><span class="o">-</span><span class="n">scan</span><span class="o">/</span><span class="n">dvpwa</span><span class="o">-</span><span class="n">test</span><span class="o">/</span><span class="n">dvpwa</span><span class="o">/</span><span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
<span class="o">@@</span> <span class="o">-</span><span class="mi">1</span> <span class="o">+</span><span class="mi">1</span> <span class="o">@@</span>
<span class="o">-</span><span class="n">idna</span><span class="o">==</span><span class="mf">2.8</span>
<span class="o">+</span><span class="n">idna</span><span class="o">&gt;=</span><span class="mf">3.0</span>
<span class="err">```</span>
</pre></div>
</div>
                    </div>
                </div>

                <h4><i class="fas fa-lightbulb"></i> AI-Powered Explanation</h4>
                <div class="ai-explanation">
                    1. **Vulnerability Analysis:**<br><br>The `idna==2.8` dependency is vulnerable to denial-of-service attacks because it contains flaws in its handling of specially crafted internationalized domain names (IDNs), allowing attackers to trigger resource exhaustion or crashes.<br><br><br>2. **Secure Code Fix:**<br><br>```diff<br>--- a/home/anirudh/Projects/impact-scan/dvpwa-test/dvpwa/requirements.txt<br>+++ b/home/anirudh/Projects/impact-scan/dvpwa-test/dvpwa/requirements.txt<br>@@ -1,3 +1,3 @@<br>-idna==2.8<br>-+idna&gt;=3.0<br>```<br><br>3. **Justification and Citation:**<br><br>The fix upgrades `idna` to version 3.0 or higher.  This addresses the known denial-of-service vulnerabilities present in version 2.8 by incorporating patches that improve the robustness of IDN encoding and handling.  While a specific CVE for the denial-of-service vulnerability in idna 2.8 might not be readily available as a single, easily linked CVE, the PyPI page for idna and release notes for versions 3.0 and beyond implicitly confirm the resolution of such vulnerabilities through improved code and security hardening.  The upgrade to a newer version is the standard and recommended approach to mitigate vulnerabilities in open-source dependencies.  [https://pypi.org/project/idna/](https://pypi.org/project/idna/) (Check the release history for version 3.0 and later for details on security improvements).<br>
                </div>
                
            </div>
            <div class="card-footer">
                <strong>Rule ID:</strong> PYSEC-2024-60, GHSA-jjg7-2v4v-x38h | <strong>Source:</strong> dependency
            </div>
        </div>
        
        <div class="finding-card" id="finding-1">
            <div class="card-header low">
                <h3><i class="fas fa-info-circle"></i> Vulnerable Dependency: pyyaml@3.13</h3>
            </div>
            <div class="card-body">
                <div class="finding-location">
                    <i class="fas fa-file-code"></i> <strong>File:</strong> /home/anirudh/Projects/impact-scan/dvpwa-test/dvpwa/requirements.txt
                </div>
                <div class="grid-container">
                    <div class="grid-item">
                        <h4><i class="fas fa-exclamation-triangle"></i> Vulnerable Code</h4>
                        <div class="code-container"><pre><code>pyyaml==3.13</code></pre></div>
                    </div>
                    <div class="grid-item">
                        <h4><i class="fas fa-shield-alt"></i> Secure Code Fix</h4>
                        <div class="code-container"><div class="highlight"><pre><span></span><span class="err">```</span><span class="n">diff</span>
<span class="o">---</span> <span class="n">a</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">anirudh</span><span class="o">/</span><span class="n">Projects</span><span class="o">/</span><span class="n">impact</span><span class="o">-</span><span class="n">scan</span><span class="o">/</span><span class="n">dvpwa</span><span class="o">-</span><span class="n">test</span><span class="o">/</span><span class="n">dvpwa</span><span class="o">/</span><span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
<span class="o">+++</span> <span class="n">b</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">anirudh</span><span class="o">/</span><span class="n">Projects</span><span class="o">/</span><span class="n">impact</span><span class="o">-</span><span class="n">scan</span><span class="o">/</span><span class="n">dvpwa</span><span class="o">-</span><span class="n">test</span><span class="o">/</span><span class="n">dvpwa</span><span class="o">/</span><span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
<span class="o">@@</span> <span class="o">-</span><span class="mi">1</span> <span class="o">+</span><span class="mi">1</span> <span class="o">@@</span>
<span class="o">-</span><span class="n">pyyaml</span><span class="o">==</span><span class="mf">3.13</span>
<span class="o">+</span><span class="n">pyyaml</span><span class="o">&gt;=</span><span class="mf">5.4.1</span>
<span class="err">```</span>
</pre></div>
</div>
                    </div>
                </div>

                <h4><i class="fas fa-lightbulb"></i> AI-Powered Explanation</h4>
                <div class="ai-explanation">
                    1. **Vulnerability Analysis:**<br><br>The code is vulnerable because `pyyaml==3.13` uses a version of PyYAML that is susceptible to arbitrary code execution via insecure deserialization of YAML data.  Maliciously crafted YAML input could be used to execute arbitrary code on the system.<br><br><br>2. **Secure Code Fix:**<br><br>```diff<br>--- a/home/anirudh/Projects/impact-scan/dvpwa-test/dvpwa/requirements.txt<br>+++ b/home/anirudh/Projects/impact-scan/dvpwa-test/dvpwa/requirements.txt<br>@@ -1,3 +1,3 @@<br>- pyyaml==3.13<br>-+ pyyaml&gt;=6.0<br>```<br><br>3. **Justification and Citation:**<br><br>This fix upgrades PyYAML to version 6.0 or higher.  Versions 6.0 and later address the insecure deserialization vulnerabilities present in earlier versions, mitigating the risk of arbitrary code execution.  While a specific CVE isn&#x27;t directly linked to the upgrade, the PyYAML release notes and security advisories consistently highlight the importance of upgrading to address these vulnerabilities.  A comprehensive overview of PyYAML&#x27;s security considerations can be found in their documentation and release notes (though a direct link to a specific advisory for this range of CVEs is difficult to pinpoint due to the nature of the vulnerability being addressed across multiple versions).  The general principle of upgrading to the latest stable version to mitigate known vulnerabilities is a standard security practice.  (Note:  Finding a single, definitive URL for this specific vulnerability range across multiple CVEs is challenging; the fix relies on the general principle of upgrading to a secure version.)<br>
                </div>
                
            </div>
            <div class="card-footer">
                <strong>Rule ID:</strong> PYSEC-2018-49, PYSEC-2021-142, GHSA-8q59-q68h-6hv4, GHSA-rprw-h62v-c2w7 | <strong>Source:</strong> dependency
            </div>
        </div>
        </div></div>
        <div class="report-footer">
            <p>&copy; 2025 Impact Scan. All rights reserved.</p>
        </div>
    </div>
</body>
</html>
        